{# PDF Viewer Component
   Usage: {% pdf "path/to/file.pdf", "Optional Title" %}
#}
{% macro render(pdfPath, title) %}
<div class="pdf-viewer-container my-6">
  {% if title %}
  <h3 class="text-xl font-bold mb-4">{{ title }}</h3>
  {% endif %}

  <div class="border border-border rounded-lg overflow-hidden bg-bg-secondary relative" id="pdf-container-{{ pdfPath | replace('/', '-') | replace('.', '-') }}">
    <iframe
      src="{{ pdfPath | url }}"
      width="100%"
      height="800px"
      style="border: none;"
      title="PDF Viewer"
      id="pdf-iframe-{{ pdfPath | replace('/', '-') | replace('.', '-') }}">
    </iframe>
  </div>

  <div class="mt-4 flex gap-4 flex-wrap">
    <a href="{{ pdfPath | url }}"
       target="_blank"
       class="inline-flex items-center px-4 py-2 bg-accent text-white rounded hover:opacity-90 transition-opacity">
      ðŸ”— Abrir en nueva pestaÃ±a
    </a>
    <button
       onclick="toggleFullscreen('pdf-container-{{ pdfPath | replace('/', '-') | replace('.', '-') }}')"
       class="inline-flex items-center px-4 py-2 bg-bg-tertiary border border-accent text-accent rounded hover:bg-accent hover:text-white transition-colors">
      â›¶ Pantalla completa
    </button>
    <a href="{{ pdfPath | url }}"
       download
       class="inline-flex items-center px-4 py-2 border border-border text-text-muted rounded hover:border-accent hover:text-accent transition-colors">
      ðŸ“¥ Descargar PDF
    </a>
  </div>
</div>

<script>
function toggleFullscreen(containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;

  if (!document.fullscreenElement) {
    container.requestFullscreen().catch(err => {
      console.error('Error attempting to enable fullscreen:', err);
    });
  } else {
    document.exitFullscreen();
  }
}
</script>

<style>
#pdf-container-{{ pdfPath | replace('/', '-') | replace('.', '-') }}:fullscreen {
  background: black;
  display: flex;
  align-items: center;
  justify-content: center;
}

#pdf-container-{{ pdfPath | replace('/', '-') | replace('.', '-') }}:fullscreen iframe {
  width: 100%;
  height: 100%;
}
</style>
{% endmacro %}
